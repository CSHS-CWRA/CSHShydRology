<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>At-site flood frequency analysis using peaks over threshold</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">At-site flood frequency analysis using peaks over threshold</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This document presents how <code>CSHShydRology</code> can be used to perform at-site flood frequency analysis using threshold modeling. This example is illustrated using the daily discharges of the Saint-John River at Fort Kent (NB). The dataset <code>flowStJohn</code> has two columns: <code>date</code> and <code>flow</code>. The column <code>flow</code> contains numerical values reporting daily river discharges and the column <code>date</code> is of class <code>Date</code>.</p>
<p>First a verification is done to make sure that only complete years of data are included. In this case, all years are complete except 1926. See the code below.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(CSHShydRology)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">data</span>(flowStJohn)</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">## Extract the year</span></a>
<a class="sourceLine" id="cb1-5" title="5">y &lt;-<span class="st"> </span><span class="kw">format</span>(flowStJohn<span class="op">$</span>date,<span class="st">&#39;%Y&#39;</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">## Evaluate the record length of each year </span></a>
<a class="sourceLine" id="cb1-8" title="8">ty &lt;-<span class="st"> </span><span class="kw">tapply</span>(y, y, length)</a>
<a class="sourceLine" id="cb1-9" title="9"></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">## Print the years with missing values</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">print</span>(ty[<span class="kw">which</span>(ty <span class="op">&lt;</span><span class="st"> </span><span class="dv">365</span>)])</a></code></pre></div>
<pre><code>## 1926 
##   92</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co">## Identify observations associated with a complete year</span></a>
<a class="sourceLine" id="cb3-2" title="2">cid &lt;-<span class="st"> </span>y <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(ty[ty<span class="op">&gt;=</span><span class="dv">365</span>])</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">## Keep only complet year</span></a>
<a class="sourceLine" id="cb3-5" title="5">xd &lt;-<span class="st"> </span><span class="kw">cbind</span>(flowStJohn[cid,], <span class="dt">year =</span> y[cid])</a></code></pre></div>
<p>In some occasions the middle of the time series may present missing values that can be assumed to be regular streamflow values (not extreme). In this situation, one could pad the missing values with value sufficiently low so that they will not be treated as peaks.</p>
</div>
<div id="estimating-model-parameters" class="section level2">
<h2>Estimating model parameters</h2>
<p>The Function <code>FitPot</code> estimates the parameter of a Generalized Pareto distribution (GPA) assuming that the data are independent exceedances. <span class="math display">\[ 
F(x)= \exp\left\{- \left( 1-\kappa \frac{x}{\alpha} \right)^{1/\kappa} \right\}
\]</span> The recommended estimation method is the maximum likelihood (MLE), but the L-moment and moment-based method can be employed by passing the argument <code>method = &#39;lmom&#39;</code> or <code>&#39;mom&#39;</code>. For MLE, confidence intervals of the parameters are derived using the delta method, while parametric bootstrap is needed for the other methods.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co">## Random sample of GPA</span></a>
<a class="sourceLine" id="cb4-2" title="2">rx &lt;-<span class="st"> </span><span class="kw">rgpa</span>(<span class="dv">2000</span>, <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">## Fitting POT using MLE</span></a>
<a class="sourceLine" id="cb4-5" title="5">fit &lt;-<span class="st"> </span><span class="kw">FitPot</span>(rx, <span class="dt">unit =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-6" title="6"><span class="kw">print</span>(fit)</a></code></pre></div>
<pre><code>## 
## Analysis of peaks over threshold
## 
## Threshold :  0
## Number of excess :  2000
## Number of years :  2000
## Excess rate (yearly):  1
## Mean residual Life :  1.02018
## 
## Parameters :
##    alpha    kappa 
## 1.022195 0.001976 
## 
## std.err :
##   alpha   kappa 
## 0.03229 0.02232</code></pre>
<p>In some occasions symmetrical confidence intervals can be unrealistic.<br />
In this case, one should prefer the confidence intervals provided by the profile likelihood method as returned by the function <code>coef</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co">## Show assymetrical confidence intervals</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">round</span>(<span class="kw">coef</span>(fit, <span class="dt">ci =</span> <span class="ot">TRUE</span>),<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##       estimate  lower upper
## alpha    1.022  1.022 1.248
## kappa    0.002 -0.045 2.000</code></pre>
<p>At this stage, the Anderson-Darling test can be used to verify if the observed peaks were likely to have been generated by a GPA distribution. By default, this probability that the sample was generated by the GPA distribution (p-value) is interpotaled using the table provided by Choulaki and Stephen (2001), which is bound to a 0.5 for practical reason. Higher p-values show more evidence of a proper model. Alternatively, parametric bootstraps can be used to evaluate the p-values using the argument <code>method = &#39;ad&#39;</code> and the number of necessary simulations. As expected, the example below shows high p-values that confirms that the data was indeed simulated from a GPA distribution.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co">## AD test using MLE and a table</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">GofTest</span>(fit)</a></code></pre></div>
<pre><code>## 
## Goodness-of-fit test
##  
## Test = Anderson-Darling 
## Distribution = gpa
## statistic : 0.1806 
## p-value : 0.5</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co">## AD test using the method of moment and bootstrap. </span></a>
<a class="sourceLine" id="cb10-2" title="2">fitm &lt;-<span class="st"> </span><span class="kw">FitPot</span>(rx, <span class="dt">method =</span> <span class="st">&#39;mom&#39;</span>, <span class="dt">varcov =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">GofTest</span>(fitm, <span class="dt">method =</span> <span class="st">&#39;ad&#39;</span>, <span class="dt">nsim =</span> <span class="dv">500</span>)</a></code></pre></div>
<pre><code>## 
## Goodness-of-fit test
##  
## Test = Anderson-Darling 
## Distribution = gpa
## statistic : 0.1794 
## p-value : 0.922</code></pre>
</div>
<div id="selecting-the-threshold" class="section level2">
<h2>Selecting the threshold</h2>
<p>An important aspect of threshold modeling is the selection of the threshold. This decision is normally based on the notion of stability, which entails that if <span class="math inline">\(u\)</span> is a well-chosen threshold then all the exceedances for all thresholds <span class="math inline">\(u^\ast \geq u\)</span> follow a GPA with the same shape parameter. The objective is therefore to find the lowest threshold that ensures such stability. One visual assessment of the threshold stability is provided by the mean residual life plot (MRL). In this graph, the mean of the exceedances is plotted against a list of candidate thresholds. When stability is reached, the MRL plot should exhibit a linear trend. In the figure below, the MRL plot indicates that thresholds greater than 1000 are reasonable choices. Note that a declustering method is used to extract independent peaks, which will be discussed later.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">## List of candidate thresholds</span></a>
<a class="sourceLine" id="cb12-2" title="2">ulst &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">500</span>,<span class="dv">1500</span>, <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co">## Mean residual life plot</span></a>
<a class="sourceLine" id="cb12-5" title="5">r0 &lt;-<span class="st"> </span><span class="dv">14</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="kw">PlotMrl</span>(flow<span class="op">~</span>date, xd, <span class="dt">u =</span> ulst, <span class="dt">declust =</span> <span class="st">&#39;wrc&#39;</span>, <span class="dt">r =</span> r0)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>However, due to sampling error, MRL plots do not always lead to a clear cut decision. Another approach for selecting a threshold is by looking directly at the evolution of the shape parameter with respect to the thresholds. The function <code>SearchThresh</code> returns key statistics of the POT model for several candidate thresholds. The graphics below show that above <code>u = 1000</code> the shape parameter is stable and leads to coherent estimated flood quantiles. Vertical lines are references that shows the nearest candidate thresholds associated with 1 and 1.5 peaks per years .</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">candidates &lt;-<span class="st"> </span><span class="kw">SearchThresh</span>(flow<span class="op">~</span>date, xd, <span class="dt">u =</span> ulst, <span class="dt">declust =</span> <span class="st">&#39;wrc&#39;</span>, <span class="dt">r =</span> r0,</a>
<a class="sourceLine" id="cb13-2" title="2">                           <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb13-3" title="3"></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="kw">PlotThresh</span>(candidates,  <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&#39;kappa&#39;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAYFBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6OpA6kNtmAABmADpmAGZmkJBmtv+QOgCQOmaQZgCQkGaQkNuQ2/+2ZgC2/7a2///bkDrb2//b////tmb/25D//7b//9v///9GuWn/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAPN0lEQVR4nO2di3qbOhZGSZOeTnJmkpkz8SkTcnn/txwLjI0dwJL+LZDwWt/X1o3xlgwruoJUfQEIVGtnAMoGgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUACgUAiRKCPp8f9301VVT9+p8oPFEawQPX9m3v1nCxHUBShAh3UaTUCCBbo/WcrUEMlBi2UQCARJtC+/Vw9fPXNaYDQbvzeobvXfUcMf6CDcSCQMBaogo2QWKB6ohdGgbYRUgt0GSVYXMibhQVKFQ7WAoFAIpFAny9dRTU5Do1AGyGNQHU//jM5EIRAGyGJQJ8vR22mpjIQaCMkEWhwE8fUZCoCbQRKIJBI1QY6FEG0gbZOol5YNx9fVZM3cyDQRmAcCCQQCCQQCCQQCE64Oe7AK4NAcBCnvyRhEiHQzTN2a43/5UEgGKcvlc5Kp5HDvOOZ5CpVOIgj4Ma+iUMRCPwZkQiBbhab24oRaLvMGWJ2UzoCbY8rzV7bk49A6bD8LfcNdZmm1kf3SdD8wFXC5cWgBPAa273oMA8v+vHzHidsSthq8L7581QIZMuoMD6CjMW5UppUF6JOZyqBOIPYxgeuEm51Qn+7ldJgTMLVQCADFryC2T3Si0AggUAi2RUJC4NAIIFAArde+jgWFmhDy7ts4CtYQAkUReHZNwSBYig796YgUChUXWcgUBil5jsZCBREodlOSIRAzaEfJe3Dw5XYCKECfTy1Wxh8tavYCRuplChQiXlOTqBA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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">PlotThresh</span>(candidates,  <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&#39;q2&#39;</span>,<span class="st">&#39;q5&#39;</span>,<span class="st">&#39;q10&#39;</span>,<span class="st">&#39;q20&#39;</span>,<span class="st">&#39;q50&#39;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The process of selecting a good threshold can be automatized using a goodness of fit test like the AD test (Davison and Smith, 1990). The function <code>SearchThresh</code> also extracts the p-value of that test for every candidate threshold. The figure below shows that below a threshold of approximately 900, the p-values of the AD test are low and do not support the hypothesis of a GPA. After this changing point, the p-values increase until reaching 0.5 for a threshold of about 950.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">PlotThresh</span>(candidates,  <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&#39;ad&#39;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For the common significance levels like 0.05, it was found that such procedure often selects too low of a threshold and so, Solari et al. (2017) suggested to use instead the maximum p-value. Alternatively, Durocher et al. (2018) suggested using a critical values between 0.10 and 0.25 to avoid higher probability of falsely acceptating the GPA (False positive). According to this latter criteria, the lowest stable threshold among the candidates is found at <code>u = 925</code>, while the maximum is <code>u = 950</code>. These values can be extracted using the function <code>FindThresh</code> with argument <code>method = &#39;max&#39;</code> or <code>method = &#39;sgn&#39;</code>. The argument <code>ppy</code> can be used to remove candidate thresholds that have excess rate outsite a desired interval.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="co">## Threshold with maximum AD p-value</span></a>
<a class="sourceLine" id="cb16-2" title="2">cvars &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;u&#39;</span>,<span class="st">&#39;ppy&#39;</span>,<span class="st">&#39;ad&#39;</span>,<span class="st">&#39;q50&#39;</span>)</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="kw">FindThresh</span>(candidates, <span class="dt">method =</span> <span class="st">&#39;max&#39;</span>)[,cvars]</a></code></pre></div>
<pre><code>##       u      ppy  ad      q50
## max 950 1.886364 0.5 4087.983</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="co">## First threshold with AD p-value &gt; 0.25</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">FindThresh</span>(candidates, <span class="dt">method =</span> <span class="st">&#39;sgn&#39;</span>, <span class="dt">tol.sgn =</span> <span class="fl">0.25</span>, </a>
<a class="sourceLine" id="cb18-3" title="3">           <span class="dt">ppy =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))[,cvars]</a></code></pre></div>
<pre><code>##       u      ppy        ad      q50
## sgn 925 1.977273 0.3518947 4082.018</code></pre>
<p>Another method to automatically select the threshold is to impose a given excess rate. By passing the argument <code>type = &#39;ppy&#39;</code> and <code>tol.ppy = 2.2</code>, the candidate threshold with the excess rate the closest to 2.2 is returned.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="co">## Threshold with approximately 2.2 PPY</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">FindThresh</span>(candidates, <span class="dt">method =</span> <span class="st">&#39;ppy&#39;</span>, <span class="dt">tol.ppy =</span> <span class="fl">2.2</span>)[,cvars]</a></code></pre></div>
<pre><code>##       u      ppy         ad      q50
## ppy 850 2.204545 0.02224744 4086.882</code></pre>
<p>In some situations a critical p-value such as 0.25 may not be reached or the threshold associated with a given excess rate may lead to samples that aren’t well approximated by a GPA. Mixing criteria for automatically selecting a threshold may lead to a more robust procedure (Durocher et al., 2018). The approach <code>sgn</code> has the advantage of generally leading to more precise estimations as it includes more peaks and ensures that GPA is a reasonable model.<br />
The arguments <code>sgn-max</code> or <code>sgn-ppy</code> ask the function <code>FindThresh</code> to search for the <code>sgn</code> threshold and if it cannot be found, will return the alternative candidates.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co">## Create a situation where there is no treshold associated with a p-value</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co">## greater than 0.25</span></a>
<a class="sourceLine" id="cb22-3" title="3">candidates.mod &lt;-<span class="st"> </span>candidates</a>
<a class="sourceLine" id="cb22-4" title="4">candidates.mod<span class="op">$</span>ad &lt;-<span class="st"> </span><span class="kw">pmin</span>(<span class="fl">0.2</span>, candidates.mod<span class="op">$</span>ad)</a>
<a class="sourceLine" id="cb22-5" title="5"></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="co">## First threshold with AD p-value &gt; 0.25</span></a>
<a class="sourceLine" id="cb22-7" title="7"><span class="kw">FindThresh</span>(candidates.mod, <span class="dt">method =</span> <span class="st">&#39;sgn-ppy&#39;</span>, </a>
<a class="sourceLine" id="cb22-8" title="8">           <span class="dt">tol.sgn =</span> <span class="fl">0.25</span>, <span class="dt">tol.ppy =</span> <span class="fl">2.2</span>)[,cvars]</a></code></pre></div>
<pre><code>##           u      ppy         ad      q50
## sgn-ppy 850 2.204545 0.02224744 4086.882</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">FindThresh</span>(candidates.mod, <span class="dt">method =</span> <span class="st">&#39;sgn-ppy&#39;</span>, </a>
<a class="sourceLine" id="cb24-2" title="2">           <span class="dt">tol.sgn =</span> <span class="fl">0.15</span>, <span class="dt">tol.ppy =</span> <span class="fl">2.2</span>)[,cvars]</a></code></pre></div>
<pre><code>##           u      ppy        ad      q50
## sgn-ppy 900 2.045455 0.1941356 4081.048</code></pre>
<p>With the approach <code>sgn</code>, the function <code>FindThresh</code> can also reject thresholds where the relative discrepency between the flood quantile of the selected threshold and a reference threshold is too large. This serves as an additional verification that flood quantiles tend to remain stable after the selected threshold. The reference threshold is defined as the average of the flood quantiles associated with the 5 lowest thresholds among the candidates. In the example below, the argument <code>ppy = c(1,3)</code> is used to impose a lower bound of 1 PPY which leads to a reference of about 1 PPY. With the St-John River, the flood quantiles quickly stabilize. After a threshold of <code>u = 825</code>, the relative discrepencies between the selected and reference threshold is less than 1%. This behavior is produced by a distribution with a light tail.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co">## Verify the discrepencies with reference threshold ~ 1PPY</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">FindThresh</span>(candidates, <span class="dt">method =</span> <span class="st">&#39;sgn&#39;</span>, <span class="dt">ppy =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">tol.sgn =</span> <span class="fl">0.0</span>, </a>
<a class="sourceLine" id="cb26-3" title="3">           <span class="dt">qua =</span> <span class="st">&#39;q50&#39;</span>, <span class="dt">tol.qua =</span> <span class="fl">.01</span>)[,cvars]</a></code></pre></div>
<pre><code>##       u      ppy    ad      q50
## sgn 825 2.329545 0.001 4110.183</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">FindThresh</span>(candidates, <span class="dt">method =</span> <span class="st">&#39;sgn&#39;</span>, <span class="dt">ppy =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">tol.sgn =</span> <span class="fl">0.25</span>, </a>
<a class="sourceLine" id="cb28-2" title="2">           <span class="dt">qua =</span> <span class="st">&#39;q50&#39;</span>, <span class="dt">tol.qua =</span> <span class="fl">.01</span>)[,cvars]</a></code></pre></div>
<pre><code>##       u      ppy        ad      q50
## sgn 925 1.977273 0.3518947 4082.018</code></pre>
</div>
<div id="declustering" class="section level2">
<h2>Declustering</h2>
<p>In practice, daily streamflow evolves smoothly and declustering techniques are necessary to extract independent flood peaks above a given threshold <span class="math inline">\(u\)</span>. Without declustering, exceedances are likely to be found in clusters. Two functions are available to extract independent peaks: <code>which.cluster</code> and <code>which.floodPeaks</code>. The first method is a running declustering method that extracts the maximum of each cluster separated by at least <code>r</code> observations below the threshold. Such methods may be more appropriate for extracting rainfall events. The second method follows the recommendation of the Water Resource Council of the United States as described in Lang et al. (1999). In brief, two adjacent peaks must respect the following two conditions: (i) they must be separated by <span class="math inline">\(4+log(A)\)</span> days, where <span class="math inline">\(A\)</span> is the drainage area in square kilometers; and (ii) the minimal intermediate flow must be less than 75% of the lowest of the two peaks. The example below illustrates the extraction of the peaks by the two methods. It is seen that the choice of a declustering method has an impact on the extracted peaks.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="co">## Define a threshold and the minimum separating time. Drainage Area =  14700.</span></a>
<a class="sourceLine" id="cb30-2" title="2">thresh &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb30-3" title="3">r0 &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="dv">4</span> <span class="op">+</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">14700</span>)) <span class="co"># ~14 days</span></a>
<a class="sourceLine" id="cb30-4" title="4"></a>
<a class="sourceLine" id="cb30-5" title="5"><span class="co">## Extract peaks based on run declustering</span></a>
<a class="sourceLine" id="cb30-6" title="6">peaks1 &lt;-<span class="st"> </span><span class="kw">which.clusters</span>(flow<span class="op">~</span>date, xd, <span class="dt">u =</span> thresh, <span class="dt">r =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb30-7" title="7"></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="co">## Extract peaks based on WRC recommendations</span></a>
<a class="sourceLine" id="cb30-9" title="9">peaks2 &lt;-<span class="st"> </span><span class="kw">which.floodPeaks</span>(flow<span class="op">~</span>date, xd, <span class="dt">u =</span> thresh, <span class="dt">r =</span> r0, <span class="dt">rlow =</span> <span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb30-10" title="10"></a>
<a class="sourceLine" id="cb30-11" title="11"><span class="co">## Plot the peaks extracted for the year 1927</span></a>
<a class="sourceLine" id="cb30-12" title="12"><span class="kw">plot</span>(flow<span class="op">~</span>date, xd[xd<span class="op">$</span>year <span class="op">==</span><span class="st"> </span><span class="dv">1927</span>,],<span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;grey&#39;</span>)</a>
<a class="sourceLine" id="cb30-13" title="13"><span class="kw">abline</span>(<span class="dt">h =</span> thresh, <span class="dt">col =</span> <span class="dv">2</span> ,<span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-14" title="14"><span class="kw">points</span>(flow<span class="op">~</span>date, xd[peaks1,], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">cex=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb30-15" title="15"><span class="kw">points</span>(flow<span class="op">~</span>date, xd[peaks2,], <span class="dt">pch =</span> <span class="dv">17</span>, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb30-16" title="16"><span class="kw">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&#39;blue&#39;</span>,<span class="st">&#39;red&#39;</span>), <span class="dt">pch =</span> <span class="dv">16</span><span class="op">:</span><span class="dv">17</span>, </a>
<a class="sourceLine" id="cb30-17" title="17">       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;Cluster&#39;</span>,<span class="st">&#39;WRC&#39;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The declustering techniques are integrated into the function <code>FitPot</code> and are performed when the argument <code>declust</code> is passed. The example below leads to the identification of the same peaks as in <code>peaks2</code> above, before fitting a GPA distribution.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co">## Fit a POT model after declustering</span></a>
<a class="sourceLine" id="cb31-2" title="2">fit &lt;-<span class="st"> </span><span class="kw">FitPot</span>(flow<span class="op">~</span>date, xd, <span class="dt">u =</span> <span class="dv">1000</span>, <span class="dt">declust =</span> <span class="st">&#39;wrc&#39;</span>, <span class="dt">r =</span> r0)</a>
<a class="sourceLine" id="cb31-3" title="3"><span class="kw">print</span>(fit)</a></code></pre></div>
<pre><code>## 
## Analysis of peaks over threshold
## 
## Threshold :  1000
## Number of excess :  158
## Number of years :  88
## Excess rate (yearly):  1.7955
## Mean residual Life :  982.039
## 
## Parameters :
##     alpha     kappa 
## 1295.9003    0.3196 
## 
## std.err :
##     alpha     kappa 
## 120.26515   0.05413</code></pre>
</div>
<div id="predicting-flood-quantiles" class="section level2">
<h2>Predicting flood quantiles</h2>
<p>For the present data, the estimated shape parameter is positive, which indicates that the distribution has an upper bound <span class="math inline">\(u + \alpha/\kappa\)</span>. The flood quantiles <span class="math inline">\(x_T\)</span> of a <span class="math inline">\(T\)</span> year return period event is defined as the quantile of probability <span class="math inline">\([1-1/(\lambda T)]\)</span> of the exceedance distribution, where <span class="math inline">\(\lambda\)</span> is the excess rate (average number of exceedances per year or PPY). For the GPA distribution the flood quantiles are given by <span class="math display">\[
x_T = u + \frac{\alpha}{\kappa}\left[ 1 - \left(\lambda T\right)^{-\kappa}
\right],
\]</span> and a natural estimator of <span class="math inline">\(\lambda\)</span> is the number of flood events over the number of years of observations.</p>
<p>The flood quantiles are evaluated by the function <code>predict</code>, where the standard deviation and confidence intervals are included by passing the argument <code>ci</code>. In the example below, the profile likelihood method is used to evaluate the confidence intervals of the flood quantiles of 10 and 100 year return periods. Other available methods are the delta method (<code>delta</code>) and parametric bootstraps (<code>boot</code>). An overview of the estimated flood quantile is provided by the return level plot that express the flood quantile (return level) versus the return periods.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co">## Predict flood quantile of return period 10 and 100 years</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">predict</span>(fit, <span class="dt">rt =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">100</span>), <span class="dt">se =</span> <span class="ot">TRUE</span>, <span class="dt">ci =</span> <span class="st">&#39;profile&#39;</span>)</a></code></pre></div>
<pre><code>##         pred       se    lower    upper
## 10  3443.623 377.2849 3219.308 3713.208
## 100 4282.903 620.8015 4036.458 4834.735</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co">## Return level plot</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="kw">plot</span>(fit, <span class="dt">ci =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="nonstationary-pot-models" class="section level2">
<h2>Nonstationary POT models</h2>
<p>There are different types of trends that can affect the outcomes of a flood frequency analysis when using peaks over threshold. One possibility is a change in the number of events per years. One strategy suggested to deal with this phenomenon is to consider a time-varying threshold determined by quantile regression (Kyselý et al. 2010). Contrary to standard regression, the output of quantile regression is a parametric function, that cut the distribution at a specific probability <span class="math inline">\(\tau\)</span>. For example, <span class="math inline">\(\tau = 0.5\)</span> implies that a time-vayring median is evaluated. Please remark that due to use of a declustering technique to identify independent peaks among the daily flows, the probability <span class="math inline">\(tau\)</span> is not an estimator of exceedance rate of the peaks, although they should be connected.<br />
Having <span class="math inline">\(x(t)\)</span> the observation at time <span class="math inline">\(t\)</span> and <span class="math inline">\(u(t)\)</span>, a simple linear model for the threshold is <span class="math display">\[
 u(t) = a_1 \, t + a_0
\]</span> The example below transforms the previous daily river discharge above the daily average to create data that will require a nonstationary threshold. The nonstationary POT model with time-dependent threshold can be fitted using the function <code>FitNsPot</code>. The latter works similar to <code>FitPot</code>, but require a formula to specify the time-dependent threshold and the argument <code>tau</code> the probability of the quantile function.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="co">## Create trend in the data</span></a>
<a class="sourceLine" id="cb36-2" title="2">idm &lt;-<span class="st"> </span>xd<span class="op">$</span>flow <span class="op">&gt;</span><span class="st"> </span><span class="kw">mean</span>(xd<span class="op">$</span>flow)</a>
<a class="sourceLine" id="cb36-3" title="3">xd<span class="op">$</span>utrend &lt;-<span class="st"> </span>xd<span class="op">$</span>flow </a>
<a class="sourceLine" id="cb36-4" title="4">xd<span class="op">$</span>utrend[idm] &lt;-<span class="st"> </span>xd<span class="op">$</span>utrend[idm] <span class="op">+</span><span class="st"> </span><span class="kw">as.integer</span>(xd<span class="op">$</span>date[idm]) <span class="op">*</span><span class="st"> </span><span class="fl">0.02</span></a>
<a class="sourceLine" id="cb36-5" title="5">  </a>
<a class="sourceLine" id="cb36-6" title="6"><span class="co">## Fit the model</span></a>
<a class="sourceLine" id="cb36-7" title="7">fit &lt;-<span class="st"> </span><span class="kw">FitNsPot</span>(utrend<span class="op">~</span><span class="st"> </span>date, <span class="dt">x =</span> xd, <span class="dt">tau =</span> <span class="fl">.95</span>, <span class="dt">declust =</span> <span class="st">&#39;wrc&#39;</span>, <span class="dt">r =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb36-8" title="8">                <span class="dt">thresh =</span> <span class="op">~</span><span class="st"> </span>date)</a>
<a class="sourceLine" id="cb36-9" title="9"><span class="kw">plot</span>(fit)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>At this stage, A Poisson or logistic regression model can be used to verify if the threshold have corrected the trend in the number of peaks. The code below looks at a possible trend in the number of peaks per year using poison regression. In the result table, the p-value associated with the slope of the time-varying treshold is superior to 0.05, which suggests that the trend is significant.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="co">## Count the number of peaks per years</span></a>
<a class="sourceLine" id="cb37-2" title="2">xn &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">date =</span> fit<span class="op">$</span>data[fit<span class="op">$</span>peak,<span class="dv">2</span>])</a>
<a class="sourceLine" id="cb37-3" title="3">xn<span class="op">$</span>year &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">format</span>(xn<span class="op">$</span>date, <span class="st">&#39;%Y&#39;</span>))</a>
<a class="sourceLine" id="cb37-4" title="4">xn &lt;-<span class="st"> </span><span class="kw">aggregate</span>(date<span class="op">~</span>year, xn, length)</a>
<a class="sourceLine" id="cb37-5" title="5"></a>
<a class="sourceLine" id="cb37-6" title="6"><span class="co">## Fitting a Poisson regression model</span></a>
<a class="sourceLine" id="cb37-7" title="7">ff &lt;-<span class="st"> </span><span class="kw">glm</span>(date<span class="op">~</span>year, xn, <span class="dt">family =</span> <span class="kw">quasipoisson</span>())</a>
<a class="sourceLine" id="cb37-8" title="8"><span class="kw">print</span>(<span class="kw">summary</span>(ff)<span class="op">$</span>coef, <span class="dt">digit =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -4.87859    4.00686   -1.22    0.227
## year         0.00275    0.00203    1.36    0.179</code></pre>
<p>In the previous graphics, we can see that the mean excess is parallel to the threshold as it was assumed constant. Even if the exceedance rate is constant, it is possible that the mean excess is also time-dependent. Considering <span class="math inline">\(m(t)\)</span> the mean excess, a nonstationary model that considers both a time-varying threshold and mean excess may assume that at each time <span class="math inline">\(t\)</span> the distribution of the standardized values</p>
<p><span class="math display">\[
z(t) = \frac{x(t) - u(t)}{m(t)}
\]</span> is constant and follows a GPA with mean equal to 1. Noting that the mean and variance of a GPA are <span class="math display">\[
\begin{align}
\mu &amp;= \frac{\alpha}{1+\kappa} \\
\sigma^2 &amp; = \frac{\mu^2}{1+2\kappa}  
\end{align}
\]</span> these assumptions imply that <span class="math inline">\(z(t)\)</span> follows a <span class="math inline">\(GPA(1+\kappa, \kappa)\)</span>. The trend in the mean excess can be estimated by maximum likelihood or by regression. For the regression approach, the quasi-likelihood method is used in this situation because it treats <span class="math inline">\(\kappa\)</span> as a nuisance parameter and take into account that the square relation between the mean and the variance (Durocher et al., 2019). After the fitting of the model is done, the <span class="math inline">\(\kappa\)</span> parameter can be estimated from the standardized values using moment-based estimators. By default a combination of regression and L-moments method is invoked by using <code>method = &#39;reg-lmom&#39;</code> or by <code>&#39;reg-mom&#39;</code> to use classical moments. For the maximum likelihood estimates the method must be set to <code>&#39;mle&#39;</code>. The example below employed constant, linear model and a second order polynomial model to describe the evolution of the mean excess. An AIC can be evaluated based ont the standardized values. It should be pointed out that this criterion cannot be used to select or verify the validity of the time-varying threshold as it assumes the threshold to be known. The results below suggest that the linear trend is the best model according to its AIC. Other tests for detecting trends, like the test of Mann-Kendall, could also be employed to look at the significance of the trend in the mean excess.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co">## Fit the model</span></a>
<a class="sourceLine" id="cb39-2" title="2">fit0 &lt;-<span class="st"> </span><span class="kw">FitNsPot</span>(flow<span class="op">~</span><span class="st"> </span>date, <span class="dt">x =</span> xd, <span class="dt">tau =</span> <span class="fl">.95</span>, <span class="dt">declust =</span> <span class="st">&#39;wrc&#39;</span>, <span class="dt">r =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb39-3" title="3">                <span class="dt">trend =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb39-4" title="4"></a>
<a class="sourceLine" id="cb39-5" title="5">fit &lt;-<span class="st"> </span><span class="kw">FitNsPot</span>(flow <span class="op">~</span><span class="st"> </span>date, <span class="dt">x =</span> xd, <span class="dt">tau =</span> <span class="fl">.95</span>, <span class="dt">declust =</span> <span class="st">&#39;wrc&#39;</span>, <span class="dt">r =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb39-6" title="6">                <span class="dt">trend =</span> <span class="op">~</span><span class="st"> </span>date)</a>
<a class="sourceLine" id="cb39-7" title="7"></a>
<a class="sourceLine" id="cb39-8" title="8">fit3 &lt;-<span class="st"> </span><span class="kw">FitNsPot</span>(flow<span class="op">~</span><span class="st"> </span>date, <span class="dt">x =</span> xd, <span class="dt">tau =</span> <span class="fl">.95</span>, <span class="dt">declust =</span> <span class="st">&#39;wrc&#39;</span>, <span class="dt">r =</span> <span class="dv">14</span>,</a>
<a class="sourceLine" id="cb39-9" title="9">                <span class="dt">trend =</span> <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(date,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb39-10" title="10"></a>
<a class="sourceLine" id="cb39-11" title="11"><span class="kw">c</span>(<span class="kw">AIC</span>(fit0), <span class="kw">AIC</span>(fit), <span class="kw">AIC</span>(fit3))</a></code></pre></div>
<pre><code>## [1] 294.0361 290.7251 292.8038</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">plot</span>(fit)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>In the nonstationary framework, the probability of exceedance of an event dependent of the time <span class="math inline">\(t\)</span> and so, the notion of return period in terms of an expected waiting time must be generalized. Although such generalizations exist, it is not a practical approach as it requires the extrapolation of the trends over a long period of time. For example, to estimate a 100-year event we need to evaluate a trend over more than 100 years, which is impossible to do accurately. Nevertheless, it is still common in practice to call <span class="math inline">\(x_p(t)\)</span> a <span class="math inline">\(T\)</span>-year event.</p>
<p>Another way to look at flood risks is in terms of a number of exceeding events. Reliability is defined as the probability that no event exceeds a given design level during a finite period of time. The opposite is the risk of failure, which corresponds to the probability that at least one such event occurs. Let’s denote <span class="math inline">\(p_i(x_R)\)</span> the probability of not exceeding <span class="math inline">\(x_R\)</span> at year <span class="math inline">\(t_i\)</span>, the reliability of the design level <span class="math inline">\(x_R\)</span> over a period <span class="math inline">\(t_1, \ldots, t_s\)</span> is <span class="math display">\[
R = \prod_{i=1}^s p_i(x_R).
\]</span> Note that is assumes that <span class="math inline">\(Z(t_i)\)</span> is independent of <span class="math inline">\(Z(t_j)\)</span> for <span class="math inline">\(i\neq j\)</span>. This can be solved numerically to identify a design flood of a given level <span class="math inline">\(R\)</span>. It should be noted that in the stationary framework, the reliability of an event of probability <span class="math inline">\(p\)</span> over <span class="math inline">\(s\)</span> years is <span class="math inline">\(R = p^s\)</span>. For instance, for <span class="math inline">\(T = 20\)</span> and <span class="math inline">\(N = 30\)</span> we have a reliability of <span class="math inline">\(0.95^{30} \approx 0.215\)</span>, which at the opposite implies that we have a risk of failure of <span class="math inline">\(0.785\)</span>. For the rest of the document, we will use this relationship to define a design level of return period <span class="math inline">\(T\)</span> as an event with reliability <span class="math inline">\(p^s\)</span>. Accordingly <span class="math inline">\(p\)</span> is the geometric mean of the <span class="math inline">\(p_i(x_R)\)</span> and therefore the design level of return period <span class="math inline">\(T\)</span> is a central measure for the flood quantiles <span class="math inline">\(x_p(t)\)</span> during the same return period.</p>
<p>The example below illustrates how the function <code>fitted</code> is used to extract the components of the nonstationary model at a specific date. In the following, we will use the values of July 15th as an approximation of the yearly flood risk and we will focus on the last 30 years. The flood quantiles and the design level are evaluated with the function <code>predict</code> for different return period.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">yr &lt;-<span class="st"> </span><span class="kw">which.day</span>(flowStJohn<span class="op">$</span>date, <span class="st">&#39;0715&#39;</span>)</a>
<a class="sourceLine" id="cb42-2" title="2">yr &lt;-<span class="st"> </span>yr[<span class="dv">59</span><span class="op">:</span><span class="dv">88</span>]</a>
<a class="sourceLine" id="cb42-3" title="3"></a>
<a class="sourceLine" id="cb42-4" title="4"><span class="co">## Extract the threshold and trend</span></a>
<a class="sourceLine" id="cb42-5" title="5">xf &lt;-<span class="st"> </span><span class="kw">fitted</span>(fit, <span class="dt">newdata =</span> flowStJohn[yr,])</a>
<a class="sourceLine" id="cb42-6" title="6"><span class="kw">head</span>(xf)</a></code></pre></div>
<pre><code>##             time original threshold    trend      scale
## 21473 1985-07-15    219.0      1080 978.7137 -0.8797261
## 21838 1986-07-15    216.0      1080 980.5844 -0.8811072
## 22203 1987-07-15    134.0      1080 982.4550 -0.9628939
## 22569 1988-07-15    198.0      1080 984.3308 -0.8960402
## 22934 1989-07-15     98.0      1080 986.2014 -0.9957398
## 23299 1990-07-15     68.8      1080 988.0721 -1.0234071</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co">## Graph of the </span></a>
<a class="sourceLine" id="cb44-2" title="2"><span class="kw">plot</span>(fit, <span class="dt">do.legend =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb44-3" title="3"></a>
<a class="sourceLine" id="cb44-4" title="4">qua &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">rt =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>), <span class="dt">newdata =</span> flowStJohn)</a>
<a class="sourceLine" id="cb44-5" title="5">rel &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, <span class="dt">rt =</span> <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">50</span>), <span class="dt">newdata =</span> flowStJohn[yr,],</a>
<a class="sourceLine" id="cb44-6" title="6">               <span class="dt">reliability =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb44-7" title="7"></a>
<a class="sourceLine" id="cb44-8" title="8"><span class="kw">lines</span>(flowStJohn<span class="op">$</span>date, qua[,<span class="dv">1</span>], <span class="dt">col =</span> <span class="st">&#39;magenta&#39;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb44-9" title="9"><span class="kw">arrows</span>(<span class="kw">min</span>(xf<span class="op">$</span>time), rel[<span class="dv">1</span>], <span class="kw">max</span>(xf<span class="op">$</span>time), <span class="dt">col =</span> <span class="st">&#39;cyan&#39;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb44-10" title="10">       <span class="dt">code =</span> <span class="dv">3</span>, <span class="dt">length =</span> <span class="fl">.1</span> )</a>
<a class="sourceLine" id="cb44-11" title="11"></a>
<a class="sourceLine" id="cb44-12" title="12"><span class="kw">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;Flood quantile&#39;</span>,<span class="st">&#39;Design level&#39;</span>), </a>
<a class="sourceLine" id="cb44-13" title="13">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&#39;magenta&#39;</span>,<span class="st">&#39;cyan&#39;</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Inference about the nonstationary model can be carried out by parametric bootstraps. The function <code>BootNsPot</code> is used to simplify that process as shown in the example below.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">hat &lt;-<span class="st"> </span><span class="kw">BootNsPot</span>(fit, <span class="dt">x =</span> flowStJohn, <span class="dt">newdata =</span> flowStJohn[yr,], <span class="dt">nsim =</span> <span class="dv">50</span>, </a>
<a class="sourceLine" id="cb45-2" title="2">                 <span class="dt">reliability =</span> <span class="ot">TRUE</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb45-3" title="3"><span class="kw">summary</span>(hat, <span class="dt">variable =</span> <span class="st">&#39;para&#39;</span>)</a></code></pre></div>
<pre><code>##                     mean           se         lower        upper
## kappa         0.38079686  0.113880075   0.231386834 6.592632e-01
## (Intercept) 966.71996845 57.422153272 865.892726187 1.079207e+03
## date          0.00538071  0.006825471  -0.007958255 1.660203e-02</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">summary</span>(hat, <span class="dt">variable =</span> <span class="st">&#39;qua&#39;</span>)</a></code></pre></div>
<pre><code>##          mean       se    lower    upper
## Q2   2470.993 147.7704 2195.153 2746.544
## Q5   3156.995 205.9844 2820.513 3584.252
## Q10  3542.833 251.8640 3164.935 4092.926
## Q20  3844.175 301.9033 3341.394 4504.241
## Q50  4146.054 370.1393 3441.002 4900.228
## Q100 4320.258 419.8546 3481.296 5127.837</code></pre>
<p>To guide the search of a threshold in the nonstationary framework, a similar approach based on the p-value of the Anderson-Darling test can be used as previously presented. The new strategy requires the application of the test on the standardized values <span class="math inline">\(z(t)\)</span>, whose by construction must GPA. This goodness-of-fit can be evaluated using the <code>GofTest</code> function. More generally the function <code>SearchThreshNs</code> can be used to automatize the process in the same ways as <code>SearchThresh</code>. In particular, the same function can be used to extract the information and help to select the threshold (e.g. <code>Findthresh</code>).</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">tau &lt;-<span class="st"> </span><span class="kw">seq</span>(.<span class="dv">93</span>, <span class="fl">.98</span>, <span class="fl">.002</span>)</a>
<a class="sourceLine" id="cb49-2" title="2">candidates.tau &lt;-<span class="st"> </span><span class="kw">SearchThreshNs</span>(flow<span class="op">~</span>date, flowStJohn, <span class="dt">tau =</span> tau, </a>
<a class="sourceLine" id="cb49-3" title="3">                       <span class="dt">trend =</span> <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(date,<span class="dv">3</span>), <span class="dt">thresh =</span> <span class="op">~</span><span class="st"> </span>date, <span class="dt">method =</span> <span class="st">&#39;mle&#39;</span>,</a>
<a class="sourceLine" id="cb49-4" title="4">                       <span class="dt">declust =</span> <span class="st">&#39;wrc&#39;</span>, <span class="dt">r =</span> <span class="dv">14</span>, <span class="dt">newdata =</span> flowStJohn[yr,])</a></code></pre></div>
<pre><code>## ===========================================================================</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="co">## First threshold with AD p-value &gt; 0.25</span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="kw">FindThresh</span>(candidates.tau, <span class="dt">method =</span> <span class="st">&#39;sgn-max&#39;</span>, <span class="dt">ppy =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))[,cvars]</a></code></pre></div>
<pre><code>##             u      ppy        ad      q50
## sgn-max 0.934 2.016954 0.3924489 4270.001</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>),<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb53-2" title="2"><span class="kw">plot</span>(ad<span class="op">~</span>u, candidates.tau, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</a>
<a class="sourceLine" id="cb53-3" title="3"><span class="kw">plot</span>(mrl<span class="op">~</span>u, candidates.tau, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</a>
<a class="sourceLine" id="cb53-4" title="4"><span class="kw">plot</span>(kappa<span class="op">~</span>u, candidates.tau, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</a>
<a class="sourceLine" id="cb53-5" title="5"><span class="kw">plot</span>(q50<span class="op">~</span>u, candidates.tau, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>In this document, it was shown how threshold modeling can be carried out<br />
to estimate flood quantiles for different return periods. Instructions for fitting the model (<code>FitPot</code>), evaluate the uncertainty of the parameters (<code>coef</code>) and derive the flood quantiles were provided (<code>predict</code>). Basic validation procedures based on the mean residual life plot (<code>PlotMrl</code>) and goodness of fit tests (<code>GofTest</code>) were shown to assess the fitting of the model.<br />
Finally, automatic procedures to select a best candidate threshold were discussed (<code>SearchThresh</code> and <code>FindThresh</code>).</p>
<p>For a general introduction to the technical aspects of threshold modeling, the reader is referred to Coles (2001) or Davison and Smith (1990).</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Choulakian, V., Stephens, M.A. (2001). Goodness-of-Fit Tests for the Generalized Pareto Distribution. Technometrics 43, 478–484. <a href="https://doi.org/10.2307/1270819" class="uri">https://doi.org/10.2307/1270819</a></p>
<p>Coles, S., 2001. An introduction to statistical modeling of extreme values. Springer Verlag.</p>
<p>Davison, A.C., Smith, R.L. (1990). Models for Exceedances over High Thresholds. Journal of the Royal Statistical Society. Series B (Methodological) 52, 393–442.</p>
<p>Durocher, M., Zadeh, S.M., Burn, D.H., Ashkar, F. (2018). Comparison of automatic procedures for selecting flood peaks over threshold based on goodness-of-fit tests. Hydrological Processes 0. <a href="https://doi.org/10.1002/hyp.13223" class="uri">https://doi.org/10.1002/hyp.13223</a></p>
<p>Durocher, M., Burn, D. H., &amp; Ashkar, F. (2019). Comparison of estimation methods for a nonstationary index-flood model in flood frequency analysis using peaks over threshold [Preprint]. <a href="https://doi.org/10.31223/osf.io/rnepc" class="uri">https://doi.org/10.31223/osf.io/rnepc</a></p>
<p>Kyselý, J., Picek, J., &amp; Beranová, R. (2010). Estimating extremes in climate change simulations using the peaks-over-threshold method with a non-stationary threshold. Global and Planetary Change, 72(1), 55–68. <a href="https://doi.org/10.1016/j.gloplacha.2010.03.006" class="uri">https://doi.org/10.1016/j.gloplacha.2010.03.006</a></p>
<p>Lang, M., Ouarda, T.B.M.J., Bobée, B. (1999). Towards operational guidelines for over-threshold modeling. Journal of Hydrology 225, 103–117. <a href="https://doi.org/10.1016/S0022-1694(99)00167-5" class="uri">https://doi.org/10.1016/S0022-1694(99)00167-5</a></p>
<p>Solari, S., Egüen, M., Polo, M.J., Losada, M.A. (2017). Peaks Over Threshold (POT): A methodology for automatic threshold estimation using goodness of fit p-value. Water Resour. Res. 53, 2833–2849. <a href="https://doi.org/10.1002/2016WR019426" class="uri">https://doi.org/10.1002/2016WR019426</a></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
