<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>At-site flood frequency analysis using annual maxima</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">At-site flood frequency analysis using annual maxima</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This document shows how to use <code>CSHShydRology</code> to perform at-site flood frequency analysis using annual maxima of river discharge. The procedure is illustrated using daily streamflow data from the Saint-John River at Fort Kent (NB). The dataset <code>flowStJohn</code> has two columns: <code>date</code> and <code>flow</code>. In column <code>flow</code> contains numerical value corresponding to daily river discharges and the variable <code>date</code> representing the day it was recorded. Note that the columns <code>date</code> is part of the class <code>Date</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(CSHShydRology)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">data</span>(<span class="st">&quot;flowStJohn&quot;</span>)</a></code></pre></div>
<p>The annual maxima may be already available in the form of a vector of data, but it can also be extracted from a time series of daily values. For this example, we need to extract the annual maxima. This extraction can be done using the function <code>ExtractAmax</code>. Here, incomplete years of data (less than 365 days) are removed. The argument <code>tol</code> can be adjusted to lower values to allow some missing values each year. In total, the function identifies 88 annual maxima.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co">## Extract the annual maxima</span></a>
<a class="sourceLine" id="cb2-2" title="2">an &lt;-<span class="st"> </span><span class="kw">ExtractAmax</span>(flow <span class="op">~</span><span class="st"> </span>date, flowStJohn, <span class="dt">tol =</span> <span class="dv">365</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">nrow</span>(an)</a></code></pre></div>
<pre><code>## [1] 88</code></pre>
<p>The annual maxima are assumed to be independent and identically distributed. To verify the likelihood of these hypothesis tests should performed to look for potential trends (Mann-Kendall) or change points (Pettitt). Risk is commonly measured in terms of return period <span class="math inline">\(T\)</span>, which characterizes the average waiting time between two extreme events, which is equivalent to evaluate the flood quantile associated with the probability <span class="math inline">\(p = 1-1/T\)</span>.</p>
</div>
<div id="estimation-of-the-flood-quantiles" class="section level2">
<h2>Estimation of the flood quantiles</h2>
<p>Different distributions can be considered to model the annual maxima. Nevertheless, according to extreme value theory the distribution of sample maxima should converge to a Generalized Extreme Value (GEV) distribution as the size of the sample increase <span class="math display">\[
F(x) = \exp\left\{ - \left[ 1 - \kappa \left(\frac{x-\xi}{\alpha} \right) 
  \right]^{1/\kappa} \right\}.
\]</span> where <span class="math inline">\(\xi\)</span> is a location parameter, <span class="math inline">\(\alpha &gt; 0\)</span> is a scale parameter and <span class="math inline">\(\kappa\)</span> is a shape parameter. The GEV distribution can be fitted using the <code>FitAmax</code> function. The example below used the maximum likelihood method to estimate the<br />
three parameters of the GEV distribution.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">fitMle &lt;-<span class="st"> </span><span class="kw">FitAmax</span>(an<span class="op">$</span>flow, <span class="st">&#39;gev&#39;</span>, <span class="dt">method =</span> <span class="st">&#39;mle&#39;</span>)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">print</span>(fitMle)</a></code></pre></div>
<pre><code>## 
## At-site frequency analysis
## 
## Distribution: gev 
## AIC: 1411 
## Method: mle
## Estimate:
##        xi     alpha     kappa 
## 2101.3761  668.9518    0.1667 
## 
## Std.err:
##       xi    alpha    kappa 
## 78.39437 54.31311  0.06214 
## 
## Lmoments:
##     l1  lcv     lsk    lkt
## 1 2390 0.17 0.05924 0.1399</code></pre>
<p>Alternatively, the L-moment method can be specified by passing the argument <code>method = &#39;lmom&#39;</code>. By default, <code>FitAmax</code> evaluates the covariance matrix of the estimated parameters. This is derived analytically for the maximum likelihood method, while for the L-moment method a parametric bootstrap is needed. Note, that the evaluation of the covariance matrix can be turned off by passing the arguments <code>varcov = FALSE</code>.</p>
<p>The flood quantile of the GEV distribution are evaluated according to <span class="math display">\[
x_p = 
\begin{cases}
\mu - \frac{\alpha}{\kappa}\left[ y_p^\kappa-1 \right]  &amp; \kappa \neq 0\\
\mu - \alpha \log y_p  &amp; \kappa = 0\\
\end{cases}
\]</span> where <span class="math inline">\(y_p = -\log(p)\)</span>. These quantities are provided by the function <code>predict</code>. The example below indicates how to obtain the flood quantile of return periods 10 and 100 years. The standard deviation of the flood quantiles is estimated using the Delta method, as requested by the argument <code>se = TRUE</code>. When the argument <code>ci = &#39;delta&#39;</code> is passed, confidence intervals are obtained by adding and substrating a value proportional to the standard deviation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co">## Flood quantiles of 10 and 100 return periods</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">predict</span>(fitMle, <span class="dt">q =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">99</span>), <span class="dt">se =</span> <span class="ot">TRUE</span>, <span class="dt">ci =</span> <span class="st">&#39;delta&#39;</span>, <span class="dt">alpha =</span> <span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##          pred        se    lower    upper
## 0.50 2339.216  82.44124 2203.612 2474.820
## 0.80 2989.156  99.81724 2824.971 3153.341
## 0.90 3356.637 117.79148 3162.888 3550.387
## 0.95 3668.464 144.52611 3430.740 3906.188
## 0.98 4020.327 193.47341 3702.092 4338.563
## 0.99 4250.404 238.46296 3858.167 4642.641</code></pre>
<p>Alternatively, confidence intervals can be obtained using parametric bootstraps using the option <code>ci = &#39;boot&#39;</code>. The argument <code>out.matrix</code> can be used to request that the bootstrap samples be returned.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co">## Fitting using L-moments</span></a>
<a class="sourceLine" id="cb8-2" title="2">fitLmm &lt;-<span class="st"> </span><span class="kw">FitAmax</span>(an<span class="op">$</span>flow, <span class="st">&#39;gev&#39;</span>, <span class="dt">method =</span> <span class="st">&#39;lmom&#39;</span>, <span class="dt">varcov =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb8-3" title="3"></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">## Prediction using bootstrap</span></a>
<a class="sourceLine" id="cb8-5" title="5">out &lt;-<span class="st"> </span><span class="kw">predict</span>(fitLmm, <span class="dt">q =</span> <span class="kw">c</span>(.<span class="dv">9</span>,.<span class="dv">99</span>), <span class="dt">ci =</span> <span class="st">&#39;boot&#39;</span>, </a>
<a class="sourceLine" id="cb8-6" title="6">               <span class="dt">nsim =</span> <span class="dv">500</span>, <span class="dt">out.matrix =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb8-7" title="7"></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">## Structure of the output</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="kw">names</span>(out)</a></code></pre></div>
<pre><code>## [1] &quot;pred&quot; &quot;para&quot; &quot;qua&quot;</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">print</span>(out<span class="op">$</span>pred)</a></code></pre></div>
<pre><code>##          pred    lower    upper
## 0.50 2343.576 2178.573 2523.395
## 0.80 2991.481 2775.294 3204.451
## 0.90 3353.148 3106.832 3573.943
## 0.95 3657.018 3367.372 3915.921
## 0.98 3996.138 3621.074 4374.472
## 0.99 4215.448 3764.401 4735.393</code></pre>
</div>
<div id="verification-of-the-model" class="section level2">
<h2>Verification of the model</h2>
<p>The return level plot provides a visual assessment of the fitted distribution by comparing the sample and theoretical flood quantiles. For convinience, the x-axis is expressed in term of the return periods. Below, the graphic shows that the estimated flood quantiles have a good agreement.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">## Return level plot</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">plot</span>(fitMle, <span class="dt">ci =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Another diagnostic is the goodness of fit test of Anderson-Darling that verifies if the observations were likely to be generated by a GEV distribution. A p-value superior for instance 0.05 indicates that the hypothesis of a GEV cannot be rejected at this significant level.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co">## Anderson-Darling test of goodness of fit</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">GofTest</span>(fitLmm, <span class="dt">nsim =</span> <span class="dv">500</span>)</a></code></pre></div>
<pre><code>## 
## Goodness-of-fit test
##  
## Test = Anderson-Darling 
## Distribution = gev
## statistic : 0.2591 
## p-value : 0.51</code></pre>
</div>
<div id="selection-of-the-best-distribution" class="section level2">
<h2>Selection of the best distribution</h2>
<p>The GEV distribution is not the only distribution available to carry out flood frequency analysis. Common alternatives are the shifted log-normal distribution (<code>&#39;ln3&#39;</code>), the Generalized logistic distribution (<code>&#39;glo&#39;</code>) and the Pearson type III distribution (<code>&#39;pe3&#39;</code>). These distribution can also be fitted by the function <code>FitAmax</code> as shown below.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co">## Fitting of the Log-normal distribution</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">FitAmax</span>(an<span class="op">$</span>flow, <span class="st">&#39;ln3&#39;</span>, <span class="dt">varcov =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## 
## At-site frequency analysis
## 
## Distribution: ln3 
## AIC: 1411 
## Method: lmom
## Estimate:
##       zeta      mulog   sigmalog 
## -3552.1611     8.6825     0.1214 
## 
## Lmoments:
##     l1  lcv     lsk    lkt
## 1 2390 0.17 0.05924 0.1399</code></pre>
<p>When more than one distribution is passed, a best distribution is selected using the Akaike Information Criterion (AIC). Here, all candidates have similar AIC, which indicates that all distributions represent reasonable choices.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">## Candidates distribution</span></a>
<a class="sourceLine" id="cb17-2" title="2">candidates &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;gev&#39;</span>,<span class="st">&#39;glo&#39;</span>,<span class="st">&#39;ln3&#39;</span>,<span class="st">&#39;pe3&#39;</span>)</a>
<a class="sourceLine" id="cb17-3" title="3"></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">## Function that computes the AIC for a given distribution</span></a>
<a class="sourceLine" id="cb17-5" title="5">FAIC &lt;-<span class="st"> </span><span class="cf">function</span>(d)</a>
<a class="sourceLine" id="cb17-6" title="6">   <span class="kw">AIC</span>(<span class="kw">FitAmax</span>(an<span class="op">$</span>flow, d, <span class="dt">method =</span> <span class="st">&#39;mle&#39;</span>))</a>
<a class="sourceLine" id="cb17-7" title="7"></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">## AIC of all distributions</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="kw">sapply</span>(candidates, FAIC)</a></code></pre></div>
<pre><code>##      gev      glo      ln3      pe3 
## 1411.247 1412.612 1411.144 1411.133</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co">## Automatic selection of the distribution</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">FitAmax</span>(an<span class="op">$</span>flow, candidates, <span class="dt">method =</span> <span class="st">&#39;mle&#39;</span>)<span class="op">$</span>distr</a></code></pre></div>
<pre><code>## [1] &quot;pe3&quot;</code></pre>
</div>
<div id="nonstationary-frequency-analysis" class="section level2">
<h2>Nonstationary frequency analysis</h2>
<p>Until this point, it was assumed that the exceeding probability of annual flood events were constant in time. More precisely, we were assuming that the observations <span class="math inline">\(x(t)\)</span> at time <span class="math inline">\(t\)</span> were following a stationary stochastic process <span class="math inline">\(X(t)\)</span> that is not affected by time shift, <em>i.e.</em> <span class="math inline">\(X(t) = X(t+s)\)</span> for any <span class="math inline">\(s\)</span>.<br />
In many situations, this assumption does not represent the reality of the studied phenomenon, which forces the consideration of nonstationary processes. We consider here two nonstationary models where a stationary process <span class="math inline">\(Z(t)\)</span> is combined with either an additive <span class="math inline">\(a(t)\)</span> or a multiplicative trend <span class="math inline">\(m(t)\)</span>, <span class="math display">\[
\begin{align}
X(t) &amp; = Z(t) + a(t) &amp; \mathrm{(Add)}\\
X(t) &amp; = Z(t) \times m(t) &amp; \mathrm{(Mult)}\\
\end{align}.
\]</span> Both types of trend is relevant in different situations. For the additive trend, the variance remains constant, even though the mean is evolving in time. On the other hand, both the mean and the variance increase or decrease in accordance with the multiplicative trend, while preserving the coefficient of variation at any time. The figure below illustrates the time series created by applying these two trends on the annual maximum flows.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="co">## Add a trend</span></a>
<a class="sourceLine" id="cb21-2" title="2">flow.sd &lt;-<span class="st"> </span><span class="kw">sd</span>(an<span class="op">$</span>flow)</a>
<a class="sourceLine" id="cb21-3" title="3">an<span class="op">$</span>flow.add &lt;-<span class="st"> </span>an<span class="op">$</span>flow <span class="op">+</span><span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>, <span class="dt">len =</span> <span class="kw">nrow</span>(an)) <span class="op">*</span><span class="st"> </span>flow.sd</a>
<a class="sourceLine" id="cb21-4" title="4">an<span class="op">$</span>flow.mult&lt;-<span class="st"> </span>an<span class="op">$</span>flow <span class="op">*</span><span class="st"> </span><span class="kw">seq</span>(.<span class="dv">7</span>,<span class="fl">1.3</span>, <span class="dt">len =</span> <span class="kw">nrow</span>(an))</a>
<a class="sourceLine" id="cb21-5" title="5"></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">## Recenter years to 1970</span></a>
<a class="sourceLine" id="cb21-7" title="7">an<span class="op">$</span>yy &lt;-<span class="st"> </span><span class="kw">as.integer</span>(an<span class="op">$</span>yy)</a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">plot</span>(flow<span class="op">~</span>yy, an, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">500</span>,<span class="dv">5500</span>), <span class="dt">col =</span> <span class="st">&#39;black&#39;</span>)</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">lines</span>(flow.add <span class="op">~</span><span class="st"> </span>yy, an, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb22-3" title="3"><span class="kw">lines</span>(flow.mult <span class="op">~</span><span class="st"> </span>yy, an, <span class="dt">col =</span> <span class="st">&#39;blue&#39;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb22-4" title="4"><span class="kw">legend</span>(<span class="st">&#39;topleft&#39;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">4</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>),</a>
<a class="sourceLine" id="cb22-5" title="5">       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;Original&#39;</span>, <span class="st">&#39;Add&#39;</span>, <span class="st">&#39;Mult&#39;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>One procedure to estimate the nonstationary models consists in estimating first the trend by regression and then fitting a distribution on de-trended data. This is the procedure followed by the function <code>FitNsAmax</code>. The estimated additive trend denoted <span class="math inline">\(\widehat a(t)\)</span> is obtained by fitting a regression model by least squares. Afterwards, the parameters of <span class="math inline">\(Z(t)\)</span> are estimated from the de-trended observations <span class="math inline">\(x(t)-\widehat m(t)\)</span> using L-moments. Similarly, the multiplicative trend <span class="math inline">\(\widehat m(t)\)</span> is derived from the log-linear model</p>
<p><span class="math display">\[
\log\{x(t)\} = \log\{m(t)\} + \log\{ z(t)\} = m(t)^\ast + \epsilon(t)
\]</span></p>
<p>and the application of the L-moments estimator on <span class="math inline">\(x(t)/\widehat m(t)\)</span>. Once the nonstationary model is fitted, exceeding probabilities and flood quantiles <span class="math inline">\(x_p\)</span> are evaluated using the formula <span class="math display">\[
\Pr\left\{ Z(t) &gt; x_p - \widehat a(t)  \right\}.
\]</span> for the additive trend and <span class="math display">\[
\Pr\left\{ Z(t) &gt; \frac{x_p}{\widehat m(t)}  \right\}.
\]</span> for the multiplicative trend.</p>
<p>In the nonstationary framework, the probability of exceeding a specific event time specific and so, the notion of return period in terms of an expected waiting time must be generalized. Although such a generalization exist, it is not a practical approach because it require the extrapolation of a trend over a long period of time. For example, to estimate a 100-year event we need to evaluate a trend on more than 100 years in the future, which is impossible to do accuratly. Nevertheless, it is still common in practice to call <span class="math inline">\(x_p(t)\)</span> a <span class="math inline">\(T\)</span>-year event.</p>
<p>Another way of looking at flood risks is in terms of a number of exceeding events. Reliability is defined as the probability that no event exceeds a given design level during a finite period of time. At the opposite, the risk of failure corresponds to the probability that at least one exceeding event occurs. Let’s denote <span class="math inline">\(p_i(x_R)\)</span> the probability of not exceeding <span class="math inline">\(x_R\)</span> at year <span class="math inline">\(t_i\)</span>. Assuming that the stationary process <span class="math inline">\(Z(t)\)</span> is not serially correlated, the reliability of the design level <span class="math inline">\(x_R\)</span> over a period <span class="math inline">\(t_1, \ldots, t_s\)</span> is <span class="math display">\[
R = \prod_{i=1}^s p_i(x_R).
\]</span></p>
<p>This can be solved numerically to identify a flood of a given reliability level <span class="math inline">\(R\)</span>. It should be noted that in the stationary framework, the reliability of an event of probability <span class="math inline">\(p\)</span> over <span class="math inline">\(s\)</span> years is <span class="math inline">\(R = p^s\)</span>. For instance, for <span class="math inline">\(T=20\)</span> and <span class="math inline">\(N = 30\)</span> we have a reliability of <span class="math inline">\(0.95^{30} \approx 0.215\)</span>, which at the opposite implies that we have a probability of failure of <span class="math inline">\(0.785\)</span>. For the rest of the document, we will use this relationship to define a design level of return period <span class="math inline">\(T\)</span> as an event with reliability <span class="math inline">\(p^s\)</span>. Accordingly, <span class="math inline">\(p\)</span> is the geometric mean of the <span class="math inline">\(p_i(x_R)\)</span> and therefore the design level of return period <span class="math inline">\(T\)</span> is a central measure for the flood quantiles <span class="math inline">\(x_p(t)\)</span> of the same return period.</p>
<p>The example below fits three additive trends using <code>FitNsAmax</code>. The function <code>fitted</code> and <code>predict</code> are used to extract 10-year flood events. In addition, design level of the same return period are evaluated for the period starting on 1985 and ending on 2014 (30 years). The first model is a simple linear model, the second model follows represent a change point occurring in 1965 and the third model uses a spline function to approximate the combination of a long-term trend with periodic oscillations.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">fit.lin &lt;-<span class="st"> </span><span class="kw">FitNsAmax</span>(flow.add <span class="op">~</span><span class="st"> </span>yy, an, <span class="dt">distr =</span> <span class="st">&#39;gev&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;add&#39;</span>)</a>
<a class="sourceLine" id="cb23-2" title="2"><span class="kw">print</span>(fit.lin)</a></code></pre></div>
<pre><code>## 
## Nonstationary model for annual maximums
## 
## Method: LS+LMOM
## Distribution: gev
## Type: add
## Parameters
##        xi     alpha     kappa 
## -284.8652  665.0418    0.1738 
## 
## Trend:
## (Intercept)          yy 
##   -38689.96       20.85</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co">## Other non linear trends</span></a>
<a class="sourceLine" id="cb25-2" title="2">an<span class="op">$</span>stp &lt;-<span class="st"> </span><span class="kw">as.integer</span>(an<span class="op">$</span>yy<span class="op">&gt;</span><span class="dv">1965</span>)</a>
<a class="sourceLine" id="cb25-3" title="3">fit.stp &lt;-<span class="st"> </span><span class="kw">FitNsAmax</span>(flow.add <span class="op">~</span><span class="st"> </span>stp, an, <span class="dt">distr =</span> <span class="st">&#39;gev&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;add&#39;</span>)</a>
<a class="sourceLine" id="cb25-4" title="4"></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="kw">library</span>(splines)</a>
<a class="sourceLine" id="cb25-6" title="6">fit.ns &lt;-<span class="st"> </span><span class="kw">FitNsAmax</span>(flow.add <span class="op">~</span><span class="st"> </span><span class="kw">ns</span>(yy, <span class="dt">df =</span> <span class="dv">7</span>), an, <span class="dt">distr =</span> <span class="st">&#39;gev&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;add&#39;</span>)</a></code></pre></div>
<p>The figure below summarizes the output of the three nonstationary models. One can see that the time-varying 10-year flood events corresponds to vertical translation of the additive trend. The design levels of the last 30 years, illustrated by the ticker line, is found to be similar across all models, even thought the three trends appear to be relatively different.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">an85 &lt;-<span class="st"> </span>(an<span class="op">$</span>yy<span class="op">&gt;</span><span class="dv">1985</span>) </a>
<a class="sourceLine" id="cb26-2" title="2">prob &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb26-3" title="3"><span class="kw">plot</span>(flow.add<span class="op">~</span>yy, an, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>,</a>
<a class="sourceLine" id="cb26-4" title="4">     <span class="dt">xlab =</span> <span class="st">&#39;Year&#39;</span>,</a>
<a class="sourceLine" id="cb26-5" title="5">     <span class="dt">ylab =</span> <span class="st">&#39;Flow&#39;</span>)</a>
<a class="sourceLine" id="cb26-6" title="6"></a>
<a class="sourceLine" id="cb26-7" title="7">Fgraph &lt;-<span class="st"> </span><span class="cf">function</span>(fit, col){</a>
<a class="sourceLine" id="cb26-8" title="8">  hat &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, prob, <span class="dt">newdata =</span> an)</a>
<a class="sourceLine" id="cb26-9" title="9">  rhat &lt;-<span class="st"> </span><span class="kw">predict</span>(fit, prob, <span class="dt">newdata =</span> an[an85,], <span class="dt">reliability =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-10" title="10"></a>
<a class="sourceLine" id="cb26-11" title="11">  <span class="kw">lines</span>(an<span class="op">$</span>yy, <span class="kw">fitted</span>(fit), <span class="dt">col =</span> col, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb26-12" title="12">  <span class="kw">lines</span>(an<span class="op">$</span>yy, hat, <span class="dt">col =</span> col)</a>
<a class="sourceLine" id="cb26-13" title="13">  <span class="kw">lines</span>(<span class="kw">cbind</span>(an[an85,<span class="st">&#39;yy&#39;</span>], rhat), <span class="dt">col =</span> col, <span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb26-14" title="14">}</a>
<a class="sourceLine" id="cb26-15" title="15"></a>
<a class="sourceLine" id="cb26-16" title="16"><span class="kw">Fgraph</span>(fit.lin, <span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb26-17" title="17"><span class="kw">Fgraph</span>(fit.stp, <span class="st">&#39;darkgreen&#39;</span>)</a>
<a class="sourceLine" id="cb26-18" title="18"><span class="kw">Fgraph</span>(fit.ns, <span class="st">&#39;blue&#39;</span>)</a>
<a class="sourceLine" id="cb26-19" title="19"></a>
<a class="sourceLine" id="cb26-20" title="20"><span class="kw">legend</span>(<span class="st">&#39;topleft&#39;</span>, </a>
<a class="sourceLine" id="cb26-21" title="21">       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;Trend&#39;</span>, <span class="st">&#39;Quantile&#39;</span>, <span class="st">&#39;Reliability&#39;</span>),</a>
<a class="sourceLine" id="cb26-22" title="22">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&#39;darkgrey&#39;</span>,<span class="st">&#39;darkgrey&#39;</span>,<span class="st">&#39;darkgrey&#39;</span>), </a>
<a class="sourceLine" id="cb26-23" title="23">       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb26-24" title="24">       <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb26-25" title="25"></a>
<a class="sourceLine" id="cb26-26" title="26"><span class="kw">legend</span>(<span class="st">&#39;top&#39;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb26-27" title="27">       <span class="dt">legend =</span> <span class="kw">c</span>( <span class="st">&#39;Linear&#39;</span>, <span class="st">&#39;Step&#39;</span>, <span class="st">&#39;Spline&#39;</span>),</a>
<a class="sourceLine" id="cb26-28" title="28">       <span class="dt">col =</span> <span class="kw">c</span>( <span class="st">&#39;red&#39;</span>, <span class="st">&#39;darkgreen&#39;</span>,<span class="st">&#39;blue&#39;</span>), </a>
<a class="sourceLine" id="cb26-29" title="29">       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb26-30" title="30">       <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Inference about the nonstationary model is carried out by parametric bootstraps to ensure that the total variability estimated included the uncertainty associated with both the regression model and the fitted distribution. The function <code>BootNsAmax</code> is used to simplify that process as shown in the example below.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">hat &lt;-<span class="st"> </span><span class="kw">BootNsAmax</span>(fit.lin, <span class="dt">p =</span> prob, <span class="dt">reliability =</span> <span class="ot">TRUE</span>, <span class="dt">nsim =</span> <span class="dv">500</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">summary</span>(hat, <span class="dt">variable =</span> <span class="st">&#39;para&#39;</span>)</a></code></pre></div>
<pre><code>##               mean          se         lower        upper
## xi    -283.8859450 34.01113995 -349.77612399 -212.4372802
## alpha  665.5337888 61.16083210  541.23457377  771.4003833
## kappa    0.1768577  0.08148498    0.03323534    0.3357445</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">summary</span>(hat, <span class="dt">variable =</span> <span class="st">&#39;qua&#39;</span>)</a></code></pre></div>
<pre><code>##         mean       se    lower    upper
## 0.9 3597.289 127.5862 3352.862 3845.894</code></pre>
<p>An alternative to the procedure using regression to estimate deterministic trends, nonstationarity can be modeled by considering time-varying parameter of the stochastic process. For the distribution GEV, GLO, GNO and PE3, there are three parameters that respectively represent location <span class="math inline">\(\xi(t)\)</span>, scale <span class="math inline">\(\alpha(t)\)</span> and shape <span class="math inline">\(\kappa(t)\)</span>. Similarly to the previous approach, we can consider the two following models</p>
$$
<span class="math display">\[\begin{array}{ll}

\begin{cases}
\xi(t) = b(t)\\
\alpha(t) = \alpha\\
\kappa(t) = \kappa
\end{cases} &amp;,

\begin{cases}
\xi(t) = b(t)\\
\alpha(t) = \alpha \times b(t)\\
\kappa(t) = \kappa
\end{cases}

\end{array}\]</span>
<p>$$</p>
<p>where <span class="math inline">\(b(t)\)</span> is time-varying function. The first model has a similar behavior to the additive trend model as only the location of the distribution changes. The results of second model should be similar to the use of a multiplicative trend as the location and the scale are related by a constant factor.</p>
<p>The function <code>FitNsAmaxMle</code> fits these nonstationary models using the maximum likelihood technique. We illustrate it uses on the data that were created by incorporating the multiplicative trend. The results are compared the regression-based with the parameter-based model. We also considered the GNO distribution to illustrate the capacity of <code>FitNsAmax</code>. The figure below shows the dashed represent the trends as either the location parameters or the mean of the nonstationary models. Notice that both model lead to similar 10-year design level and that the difference between the trends and the 10-year flood events is growing to preserve the location-scale relationship.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">fit.mult &lt;-<span class="st"> </span><span class="kw">FitNsAmax</span>(flow.mult <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(yy, <span class="dv">3</span>), an, <span class="dt">distr =</span> <span class="st">&#39;gno&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;mult&#39;</span>)</a>
<a class="sourceLine" id="cb31-2" title="2">fit.mle &lt;-<span class="st"> </span><span class="kw">FitNsAmaxMle</span>(flow.mult <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(yy, <span class="dv">3</span>), an, <span class="dt">distr =</span> <span class="st">&#39;gno&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;mult&#39;</span>, </a>
<a class="sourceLine" id="cb31-3" title="3">                        <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">maxit =</span> <span class="dv">5000</span>))</a></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">plot</span>(flow.add<span class="op">~</span>yy, an, <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>,</a>
<a class="sourceLine" id="cb32-2" title="2">     <span class="dt">xlab =</span> <span class="st">&#39;Year (ref = 1970)&#39;</span>,</a>
<a class="sourceLine" id="cb32-3" title="3">     <span class="dt">ylab =</span> <span class="st">&#39;Flow&#39;</span>)</a>
<a class="sourceLine" id="cb32-4" title="4"></a>
<a class="sourceLine" id="cb32-5" title="5"><span class="kw">Fgraph</span>(fit.mult, <span class="st">&#39;red&#39;</span>)</a>
<a class="sourceLine" id="cb32-6" title="6"></a>
<a class="sourceLine" id="cb32-7" title="7"><span class="co">## MLE model</span></a>
<a class="sourceLine" id="cb32-8" title="8">hat &lt;-<span class="st"> </span><span class="kw">predict</span>(fit.mle, prob)</a>
<a class="sourceLine" id="cb32-9" title="9">loc &lt;-<span class="st"> </span><span class="kw">predict</span>(fit.mle, <span class="dt">type =</span> <span class="st">&#39;location&#39;</span>)</a>
<a class="sourceLine" id="cb32-10" title="10">rhat &lt;-<span class="st"> </span><span class="kw">predict</span>(fit.mle, prob, <span class="dt">newdata =</span> an[an85,], <span class="dt">type =</span> <span class="st">&#39;reliability&#39;</span>)</a>
<a class="sourceLine" id="cb32-11" title="11"></a>
<a class="sourceLine" id="cb32-12" title="12">col &lt;-<span class="st"> &#39;blue&#39;</span></a>
<a class="sourceLine" id="cb32-13" title="13"><span class="kw">lines</span>(an<span class="op">$</span>yy, loc, <span class="dt">col =</span> col, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb32-14" title="14"><span class="kw">lines</span>(an<span class="op">$</span>yy, hat, <span class="dt">col =</span> col)</a>
<a class="sourceLine" id="cb32-15" title="15"><span class="kw">lines</span>(<span class="kw">cbind</span>(an[an85,<span class="st">&#39;yy&#39;</span>], rhat), <span class="dt">col =</span> col, <span class="dt">lwd=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb32-16" title="16"></a>
<a class="sourceLine" id="cb32-17" title="17"><span class="kw">legend</span>(<span class="st">&#39;topleft&#39;</span>, </a>
<a class="sourceLine" id="cb32-18" title="18">       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;Location&#39;</span>, <span class="st">&#39;Quantile&#39;</span>, <span class="st">&#39;Reliability&#39;</span>),</a>
<a class="sourceLine" id="cb32-19" title="19">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&#39;darkgrey&#39;</span>,<span class="st">&#39;darkgrey&#39;</span>,<span class="st">&#39;darkgrey&#39;</span>), </a>
<a class="sourceLine" id="cb32-20" title="20">       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb32-21" title="21">       <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>))</a>
<a class="sourceLine" id="cb32-22" title="22"></a>
<a class="sourceLine" id="cb32-23" title="23"><span class="kw">legend</span>(<span class="st">&#39;top&#39;</span>, <span class="dt">horiz =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb32-24" title="24">       <span class="dt">legend =</span> <span class="kw">c</span>( <span class="st">&#39;Regression&#39;</span>, <span class="st">&#39;Stochastic&#39;</span>),</a>
<a class="sourceLine" id="cb32-25" title="25">       <span class="dt">col =</span> <span class="kw">c</span>( <span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>), </a>
<a class="sourceLine" id="cb32-26" title="26">       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>), </a>
<a class="sourceLine" id="cb32-27" title="27">       <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>This document showed how to evaluate flood quantiles using annual maximum of river discharge. Initially, annual maxima (<code>ExtractAmax</code>) were extracted and a GEV distribution was fitted (<code>FitAmax</code>). The AIC criteria was then used to identify if there will be a better distributions among a small group of candidates. The function to obtain the flood quantiles and their uncertainties (<code>predict</code>) was finally presented. To assess the outcomes of the model, the return level plot (<code>plot</code>) was presented as a way to visualize the quality of the fitting and a goodness of fit test was discussed (<code>GofTest</code>). For a more in depth introduction the readers are referred to Coles (2001) and Hosking and Wallis (1997).</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Coles, S., 2001. An introduction to statistical modeling of extreme values. Springer Verlag.</p>
<p>Hosking, J.R.M., Wallis, J.R., 1997. Regional frequency analysis: an approach based on L-moments. Cambridge Univ Pr.</p>
<p>Vogel, R. M., Yaindl, C., &amp; Walter, M. (2011). Nonstationarity: Flood Magnification and Recurrence Reduction Factors in the United States1. JAWRA Journal of the American Water Resources Association, 47(3), 464–474. <a href="https://doi.org/10.1111/j.1752-1688.2011.00541.x" class="uri">https://doi.org/10.1111/j.1752-1688.2011.00541.x</a></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
